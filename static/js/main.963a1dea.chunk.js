(this["webpackJsonpreact-horizontal-schedule-example"]=this["webpackJsonpreact-horizontal-schedule-example"]||[]).push([[0],{22:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return q}));var i=r(4),o=r(0),n=r.n(o),s=r(24),a=r(9),d=r.n(a),p=r(1),l=r.n(p),h=(r(38),r(39),{schedule:"_styles-module__schedule__igxG4",scheduleRow:"_styles-module__scheduleRow__1efr6",weekHeader:"_styles-module__weekHeader__3HBxs",zoom:"_styles-module__zoom__3cFKv",scheduleItem:"_styles-module__scheduleItem__2ke3f",scheduleItemDate:"_styles-module__scheduleItemDate__13zdv","easy-edit-wrapper":"_styles-module__easy-edit-wrapper__2OEUq",filter:"_styles-module__filter__22Znc",title:"_styles-module__title__2KezC",roundAvatar:"_styles-module__roundAvatar__2YIVN"});class u extends n.a.Component{constructor(e){super(e),this.onPositionUpdated=this.onPositionUpdated.bind(this),this.onSizeUpdated=this.onSizeUpdated.bind(this),this.computeStartX=this.computeStartX.bind(this),this.computeStartDate=this.computeStartDate.bind(this),this.computeThread=this.computeThread.bind(this),this.onRightClick=this.onRightClick.bind(this)}computeThread(e,t){var r=t.y;return Math.ceil(e/r)}computeStartX(e,t,r){var i=l()(e).isoWeekday()-1,o=t.find(t=>l()(t.startDate)<=l()(e)&&l()(e)<=l()(t.endDate));return(7*t.indexOf(o)+i)*r.x}computeStartDate(e,t,r){var i=r.x,o=Math.floor(Math.ceil(e/i)/7),n=Math.ceil(e/i)-7*o;return{startDate:l()(t[0].startDate).add(o,"w").add(n,"d").format("YYYY-MM-DD")}}onSizeUpdated(e,t){var r=this.props.grid.x,i=this.props.days+t.widthDelta/r;this.props.onDurationUpdated(e,i),0==i&&this.props.onRemoved(e);var o=this.computeStartDate(t.x,this.props.weeks,this.props.grid),n=this.computeThread(t.y,this.props.grid),s={startDate:o.startDate,thread:n};this.props.onPositionUpdated(e,s)}onPositionUpdated(e,t){var r=this.computeStartDate(t.x,this.props.weeks,this.props.grid),i=this.computeThread(t.y,this.props.grid);t.startDate=r.startDate,t.thread=i,this.props.onPositionUpdated(e,t)}onRightClick(e){e.preventDefault();var t=["#ffc600","#ff3b30","#34c759","#5ac8fa","#eee","#af52de"],r=t[(t.indexOf(this.props.color)+1)%(t.length-1)];this.props.onColorUpdated(this.props.id,r)}render(){var e=this.computeStartX(this.props.startDate,this.props.weeks,this.props.grid),t=this.props.thread*this.props.grid.y;return n.a.createElement(s.a,{bounds:"parent",onContextMenu:this.onRightClick,onResizeStop:(e,t,r,i,o)=>{this.onSizeUpdated(this.props.id,{x:o.x,y:o.y,widthDelta:i.width})},onDragStop:(e,t)=>{this.onPositionUpdated(this.props.id,{x:t.x,y:t.y,widthDelta:0})},position:{x:e,y:t},enableResizing:{top:!1,right:!0,bottom:!1,left:!0,topRight:!1,bottomRight:!1,bottomLeft:!1,topLeft:!1},size:{width:this.props.grid.x*this.props.days,height:this.props.grid.y},dragGrid:[1,1],resizeGrid:[this.props.grid.x,1]},n.a.createElement("div",{className:h.scheduleItem,style:{background:this.props.color,height:this.props.grid.y,userSelect:"none",overflow:"none",padding:3,border:"1px solid white",borderRadius:"5px",fontSize:"10px"}},n.a.createElement("div",{className:h.scheduleItemDate},l()(this.props.startDate).format("dd, D MMM")," (",this.props.days,"d)"),n.a.createElement("div",null,n.a.createElement(d.a,{className:h.scheduleItemInput,placeholder:this.props.title||"",onSave:e=>{this.props.onTitleUpdated(this.props.id,e)},type:a.Types.TEXT,hideSaveButton:!0,hideCancelButton:!0,saveOnBlur:!0,attributes:{name:"awesome-input",id:1}}))))}}class c extends n.a.Component{constructor(e){super(e),this.onPositionUpdated=this.onPositionUpdated.bind(this),this.onDurationUpdated=this.onDurationUpdated.bind(this),this.onTitleUpdated=this.onTitleUpdated.bind(this),this.onColorUpdated=this.onColorUpdated.bind(this),this.onRemoved=this.onRemoved.bind(this)}onRemoved(e){var t={rowId:this.props.id,itemIndex:e};this.props.itemRemoved(t),this.setState({})}onDurationUpdated(e,t){var r={rowId:this.props.id,itemIndex:e,duration:t};this.props.rowUpdated(r)}onPositionUpdated(e,t){var r={rowId:this.props.id,itemIndex:e,dimensions:t};this.props.rowUpdated(r)}onTitleUpdated(e,t){var r={rowId:this.props.id,itemIndex:e,title:t};this.props.rowUpdated(r)}onColorUpdated(e,t){var r={rowId:this.props.id,itemIndex:e,color:t};this.props.rowUpdated(r)}render(){var e={borderBottom:"1px solid #eee",position:"relative",height:this.props.threads*this.props.grid.y,width:this.props.grid.width,backgroundSize:this.props.grid.x+"px 100%",left:this.props.grid.filterOffset};return n.a.createElement("div",{style:{display:"flex"}},n.a.createElement("div",{className:h.filter,style:{display:"flex",flexShrink:0,width:this.props.grid.filterOffset}},n.a.createElement("img",{src:this.props.imgUrl,className:h.roundAvatar,alt:this.props.title}),n.a.createElement("div",{className:h.title},n.a.createElement("h5",null,this.props.title),n.a.createElement("h6",null,this.props.subtitle))),n.a.createElement("div",{style:e,className:h.scheduleRow+" schedule-row",id:this.props.id,onDoubleClick:this.props.onRowClicked},this.props.items.map((e,t)=>n.a.createElement(u,{weeks:this.props.weeks,color:e.color,grid:this.props.grid,key:t,onPositionUpdated:this.onPositionUpdated,onDurationUpdated:this.onDurationUpdated,onTitleUpdated:this.onTitleUpdated,onColorUpdated:this.onColorUpdated,onRemoved:this.onRemoved,id:t,title:e.title,days:e.days,startDate:e.startDate,thread:e.thread}))))}}var f,m,v,y="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),w="undefined"!==typeof Symbol?Symbol("immer-nothing"):(v=!0,(m="immer-nothing")in(f={})?Object.defineProperty(f,m,{value:v,enumerable:!0,configurable:!0,writable:!0}):f[m]=v,f),b="undefined"!==typeof Symbol?Symbol("immer-state"):"__$immer_state";function x(e){return!!e&&!!e[b]}function D(e){if(!e)return!1;if("object"!==("undefined"===typeof e?"undefined":y(e)))return!1;if(Array.isArray(e))return!0;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}var S=Object.assign||function(e,t){for(var r in t)U(t,r)&&(e[r]=t[r]);return e};function _(e){if(Array.isArray(e))return e.slice();var t=void 0===e.__proto__?Object.create(null):{};return S(t,e)}function k(e,t){if(Array.isArray(e))for(var r=0;r<e.length;r++)t(r,e[r],e);else for(var i in e)t(i,e[i],e)}function U(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function z(e,t){return e===t?0!==e||1/e===1/t:e!==e&&t!==t}function I(e,t,r,i){Array.isArray(e.base)?function(e,t,r,i){for(var o=e.base,n=e.copy,s=e.assigned,a=Math.min(o.length,n.length),d=0;d<a;d++)if(s[d]&&o[d]!==n[d]){var p=t.concat(d);r.push({op:"replace",path:p,value:n[d]}),i.push({op:"replace",path:p,value:o[d]})}if(a<n.length){for(var l=a;l<n.length;l++)r.push({op:"add",path:t.concat(l),value:n[l]});i.push({op:"replace",path:t.concat("length"),value:o.length})}else if(a<o.length){r.push({op:"replace",path:t.concat("length"),value:n.length});for(var h=a;h<o.length;h++)i.push({op:"add",path:t.concat(h),value:o[h]})}}(e,t,r,i):function(e,t,r,i){var o=e.base,n=e.copy;k(e.assigned,(function(e,s){var a=o[e],d=n[e],p=s?e in o?"replace":"add":"remove";if(a!==o||"replace"!==p){var l=t.concat(e);r.push("remove"===p?{op:p,path:l}:{op:p,path:l,value:d}),i.push("add"===p?{op:"remove",path:l}:"remove"===p?{op:"add",path:l,value:a}:{op:"replace",path:l,value:a})}}))}(e,t,r,i)}var O={},E=[],P=function(){return E[E.length-1]};function C(e,t){var r=void 0;if(x(e)){var i=e[b];i.finalizing=!0,r=_(i.draft),i.finalizing=!1}else r=_(e);k(e,(function(e){Object.defineProperty(r,""+e,function(e){return O[e]||(O[e]={configurable:!0,enumerable:!0,get:function(){return function(e,t){T(e);var r=N(e)[t];if(!e.finalizing&&r===e.base[t]&&D(r))return A(e),e.copy[t]=C(r,e);return r}(this[b],e)},set:function(t){!function(e,t,r){if(T(e),e.assigned[t]=!0,!e.modified){if(z(N(e)[t],r))return;j(e),A(e)}e.copy[t]=r}(this[b],e,t)}})}(""+e))}));var o={scope:t?t.scope:P(),modified:!1,finalizing:!1,finalized:!1,assigned:{},parent:t,base:e,draft:r,copy:null,revoke:R,revoked:!1};return function(e,t,r){Object.defineProperty(e,t,{value:r,enumerable:!1,writable:!0})}(r,b,o),o.scope.push(o),r}function R(){this.revoked=!0}function N(e){return e.copy||e.base}function j(e){e.modified||(e.modified=!0,e.parent&&j(e.parent))}function A(e){e.copy||(e.copy=_(e.base))}function T(e){if(!0===e.revoked)throw new Error("Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+JSON.stringify(e.copy||e.base))}function M(e){for(var t=e.base,r=e.draft,i=Object.keys(r),o=i.length-1;o>=0;o--)if(void 0===t[i[o]]&&!U(t,i[o]))return!0;return i.length!==Object.keys(t).length}function F(e){var t=e.draft;if(t.length!==e.base.length)return!0;var r=Object.getOwnPropertyDescriptor(t,t.length-1);return!(!r||r.get)}var J=Object.freeze({scopes:E,currentScope:P,willFinalize:function(e,t,r){var i=P();i.forEach((function(e){return e.finalizing=!0})),void 0!==e&&e!==t||(r&&function e(t){if(!t||"object"!==("undefined"===typeof t?"undefined":y(t)))return;var r=t[b];if(!r)return;var i=r.base,o=r.draft,n=r.assigned;if(Array.isArray(t)){if(F(r)){if(j(r),n.length=!0,o.length<i.length)for(var s=o.length;s<i.length;s++)n[s]=!1;else for(var a=i.length;a<o.length;a++)n[a]=!0;for(var d=0;d<o.length;d++)void 0===n[d]&&e(o[d])}}else Object.keys(o).forEach((function(t){void 0!==i[t]||U(i,t)?n[t]||e(o[t]):(n[t]=!0,j(r))})),Object.keys(i).forEach((function(e){void 0!==o[e]||U(o,e)||(n[e]=!1,j(r))}))}(t),function(e){for(var t=e.length-1;t>=0;t--){var r=e[t];!1===r.modified&&(Array.isArray(r.base)?F(r)&&j(r):M(r)&&j(r))}}(i))},createDraft:C}),B=[],W=function(){return B[B.length-1]};function H(e,t){var r={scope:t?t.scope:W(),modified:!1,finalized:!1,assigned:{},parent:t,base:e,draft:null,drafts:{},copy:null,revoke:null},i=Array.isArray(e)?Proxy.revocable([r],Y):Proxy.revocable(r,X),o=i.revoke,n=i.proxy;return r.draft=n,r.revoke=o,r.scope.push(r),n}var X={get:function(e,t){if(t===b)return e;var r=e.drafts;if(!e.modified&&U(r,t))return r[t];var i=Z(e)[t];if(e.finalized||!D(i))return i;if(e.modified){if(i!==e.base[t])return i;r=e.copy}return r[t]=H(i,e)},has:function(e,t){return t in Z(e)},ownKeys:function(e){return Reflect.ownKeys(Z(e))},set:function(e,t,r){if(!e.modified){if(r?z(e.base[t],r)||r===e.drafts[t]:z(e.base[t],r)&&t in e.base)return!0;K(e)}return e.assigned[t]=!0,e.copy[t]=r,!0},deleteProperty:function(e,t){(void 0!==e.base[t]||t in e.base)&&(e.assigned[t]=!1,K(e));e.copy&&delete e.copy[t];return!0},getOwnPropertyDescriptor:function(e,t){var r=e.modified?e.copy:U(e.drafts,t)?e.drafts:e.base,i=Reflect.getOwnPropertyDescriptor(r,t);!i||Array.isArray(r)&&"length"===t||(i.configurable=!0);return i},defineProperty:function(){throw new Error("Immer does not support defining properties on draft objects.")},setPrototypeOf:function(){throw new Error("Immer does not support `setPrototypeOf()`.")}},Y={};function Z(e){return e.copy||e.base}function K(e){e.modified||(e.modified=!0,e.copy=S(_(e.base),e.drafts),e.drafts=null,e.parent&&K(e.parent))}k(X,(function(e,t){Y[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),Y.deleteProperty=function(e,t){if(isNaN(parseInt(t)))throw new Error("Immer does not support deleting properties from arrays: "+t);return X.deleteProperty.call(this,e[0],t)},Y.set=function(e,t,r){if("length"!==t&&isNaN(parseInt(t)))throw new Error("Immer does not support setting non-numeric properties on arrays: "+t);return X.set.call(this,e[0],t,r)};var G=Object.freeze({scopes:B,currentScope:W,willFinalize:function(){},createDraft:H});var L={useProxies:"undefined"!==typeof Proxy&&"undefined"!==typeof Reflect,autoFreeze:"undefined"===typeof e&&"verifyMinified"===function(){}.name,onAssign:null,onDelete:null,onCopy:null};(0,(new(function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),S(this,L,t),this.setUseProxies(this.useProxies),this.produce=this.produce.bind(this)}return g(e,[{key:"produce",value:function(e,t,r){var i=this;if("function"===typeof e&&"function"!==typeof t){var o=t;return t=e,function(){for(var e=arguments.length,r=Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];var s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o;return i.produce(s,(function(e){var i;return(i=t).call.apply(i,[e,e].concat(r))}))}}if("function"!==typeof t)throw new Error("if first argument is not a function, the second argument to produce should be a function");if(void 0!==r&&"function"!==typeof r)throw new Error("the third argument of a producer should not be set or a function");var n=void 0;if(D(e))if(x(e)){if(void 0===(n=t.call(e,e)))return e}else{this.scopes.push([]);var s=this.createDraft(e);try{n=t.call(s,s),this.willFinalize(n,s,!!r);var a=r&&[],d=r&&[];if(void 0===n||n===s)n=this.finalize(s,[],a,d);else{if(s[b].modified)throw new Error("An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.");D(n)&&(n=this.finalize(n)),r&&(a.push({op:"replace",path:[],value:n}),d.push({op:"replace",path:[],value:e}))}}finally{this.currentScope().forEach((function(e){return e.revoke()})),this.scopes.pop()}r&&r(a,d)}else if(void 0===(n=t(e)))return e;return n===w?void 0:n}},{key:"setAutoFreeze",value:function(e){this.autoFreeze=e}},{key:"setUseProxies",value:function(e){this.useProxies=e,S(this,e?G:J)}},{key:"finalize",value:function(e,t,r,i){var o=e[b];if(!o)return Object.isFrozen(e)?e:this.finalizeTree(e);if(o.scope!==this.currentScope())return e;if(!o.modified)return o.base;if(!o.finalized){if(o.finalized=!0,this.finalizeTree(o.draft,t,r,i),this.onDelete){var n=o.assigned;for(var s in n)n[s]||this.onDelete(o,s)}this.onCopy&&this.onCopy(o),this.autoFreeze&&1===this.scopes.length&&Object.freeze(o.copy),r&&I(o,t,r,i)}return o.copy}},{key:"finalizeTree",value:function(e,t,r,i){var o=this,n=e[b];n&&(e=this.useProxies?n.copy:n.copy=_(n.draft));var s=this.onAssign;return k(e,(function a(d,p,l){var h=!!n&&l===e;if(x(p)){if(l[d]=p=r&&h&&!n.assigned[d]?o.finalize(p,t.concat(d),r,i):o.finalize(p),h&&p===n.base[d])return}else{if(h&&z(p,n.base[d]))return;D(p)&&!Object.isFrozen(p)&&k(p,a)}h&&s&&s(n,d,p)})),e}}]),e}())).produce)((function(e,t){for(var r=0;r<t.length;r++){var i=t[r],o=i.path;if(0===o.length&&"replace"===i.op)e=i.value;else{for(var n=e,s=0;s<o.length-1;s++)if(!(n=n[o[s]])||"object"!==("undefined"===typeof n?"undefined":y(n)))throw new Error("Cannot apply patch, path doesn't resolve: "+o.join("/"));var a=o[o.length-1];switch(i.op){case"replace":case"add":n[a]=i.value;break;case"remove":if(Array.isArray(n)){if(a!==n.length-1)throw new Error("Only the last index of an array can be removed, index: "+a+", length: "+n.length);n.length-=1}else delete n[a];break;default:throw new Error("Unsupported patch operation: "+i.op)}}}return e}));class q extends n.a.Component{constructor(e){super(e),this.state={grid:{filterOffset:e.filterWidth,y:e.timelineHeight,x:e.dayWidth,startDate:e.startDate,endDate:e.endDate},rows:e.rows},this.rowUpdated=this.rowUpdated.bind(this),this.addNewItem=this.addNewItem.bind(this),this.onZoomChanged=this.onZoomChanged.bind(this),this.itemRemoved=this.itemRemoved.bind(this)}rowUpdated(e){var t=JSON.parse(JSON.stringify(this.state.rows)),r=JSON.parse(JSON.stringify(e)),i=t[this.state.rows.findIndex(e=>e.id==r.rowId)].items[r.itemIndex];if(void 0!=i){if(void 0!=r.dimensions&&(i.startDate=r.dimensions.startDate,i.thread=r.dimensions.thread),void 0!=r.title&&(i.title=r.title),void 0!=r.duration&&(i.days=r.duration),void 0!=r.color&&(i.color=r.color),this.props.onScheduleItemUpdated)this.props.onScheduleItemUpdated(i).then(e=>{console.log("updating schedule item")},e=>{console.error("couldnt update event",e)});this.setState({rows:t})}}itemRemoved(e){var t=JSON.parse(JSON.stringify(this.state.rows)),r=this.state.rows.findIndex(t=>t.id==e.rowId),i=t[r].items[e.itemIndex];this.props.onScheduleItemRemoved?this.props.onScheduleItemRemoved(i).then(i=>{console.log("deleting on server"),t[r].items.splice(e.itemIndex,1),this.setState({rows:t})},e=>{console.error("couldnt delete event",e)}):(t[r].items.splice(e.itemIndex,1),this.setState({rows:t}))}addNewItem(e){if(e.target.className.indexOf("schedule-row")>0){var t=e.target.getBoundingClientRect(),r=e.clientY-t.y-50,i=e.clientX-t.x-this.state.grid.x,o=e.target.id,n=this.state.rows.findIndex(e=>e.id==o),s=new u,a=s.computeStartDate(i,this.state.weeks,this.state.grid),d=s.computeThread(r,this.state.grid),p=[...this.state.rows],l={startDate:a.startDate,days:this.props.newEventDays,color:"#eee",title:"New event",thread:d};if(this.props.onScheduleItemCreated)this.props.onScheduleItemCreated(o,l).then(e=>{l.id=e.id,p[n].items.push(l),this.setState({rows:p})},e=>{console.error("couldnt create event",e)});else p[n].items.push(l),this.setState({rows:p})}}onZoomChanged(e){var t=e.target.value,r=t*this.state.weeks.length*7;this.setState({grid:Object(i.a)(Object(i.a)({},this.state.grid),{},{width:r,x:t})})}componentWillMount(){for(var e=[],t=l()(this.state.grid.startDate),r=t.add(1-t.day(),"d");r<l()(this.state.grid.endDate);)e.push({weekNumber:l()(r).isoWeek(),startDate:l()(r),endDate:l()(r).add(6,"d")}),r=r.add(7,"d");var o=this.state.grid.x*e.length*7;this.setState({grid:Object(i.a)(Object(i.a)({},this.state.grid),{},{width:o})}),this.setState({weeks:e})}render(){return n.a.createElement("div",{className:h.schedule},n.a.createElement("div",{className:h.weekHeader},n.a.createElement("div",{className:h.zoom,style:{width:this.state.grid.filterOffset}},n.a.createElement("input",{onChange:this.onZoomChanged,value:this.state.grid.x,id:"zoom",type:"range",min:this.props.zoomMin,max:this.props.zoomMax,step:this.props.zoomStep})),this.state.weeks.map((e,t)=>n.a.createElement("div",{key:t,style:{width:7*this.state.grid.x}},e.weekNumber,n.a.createElement("br",null),this.state.grid.x>15&&n.a.createElement("span",null,e.startDate.format("MMM D")," - ",e.endDate.format("D"))))),this.state.rows.map((e,t)=>n.a.createElement(c,{title:e.title,subtitle:e.subtitle,imgUrl:e.imgUrl,weeks:this.state.weeks,onRowClicked:this.addNewItem,grid:this.state.grid,key:t,id:e.id,items:e.items,threads:e.threads,itemRemoved:this.itemRemoved,rowUpdated:this.rowUpdated})))}}}).call(this,r(11))},25:function(e,t,r){e.exports=r(58)},26:function(e,t,r){},57:function(e,t,r){},58:function(e,t,r){"use strict";r.r(t);r(26);var i=r(0),o=r.n(i),n=r(6),s=r.n(n),a=r(22);r(57);var d=()=>{const e=JSON.parse(document.getElementById("schedule-data").textContent),t=function(e){return new Promise((e,t)=>{e()})};return o.a.createElement(a.a,{onScheduleItemCreated:function(e,t){return new Promise((e,t)=>{e({id:98})})},onScheduleItemUpdated:t,onScheduleItemRemoved:t,newEventDays:4,filterWidth:250,startDate:e.startDate,endDate:e.endDate,timelineHeight:e.timelineHeight,dayWidth:e.dayWidth,rows:e.rows})};s.a.render(o.a.createElement(d,null),document.getElementById("root"))}},[[25,1,2]]]);
//# sourceMappingURL=main.963a1dea.chunk.js.map